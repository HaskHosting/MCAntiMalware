package optic_fusion1.mcantimalware;

import java.io.File;
import optic_fusion1.mcantimalware.check.CheckManager;
import optic_fusion1.mcantimalware.configuration.file.FileConfiguration;
import optic_fusion1.mcantimalware.logging.CustomLogger;
import optic_fusion1.mcantimalware.runtimeprotect.PluginIndex;
import optic_fusion1.mcantimalware.scanner.Scanner;

public final class AntiMalware extends AntiMalwareAPI {

  private final Main main;

  protected AntiMalware(Main main) {
    this.main = main;
    AntiMalwareAPI.setInstance(this);
  }

  public Main getMain() {
    return main;
  }

  public CommandLineParser getCommandLineParser() {
    return main.getCommandLineParser();
  }

  @Override
  public CustomLogger getLogger() {
    return main.getLogger();
  }

  @Override
  public CheckManager getCheckManager() {
    return main.getCheckManager();
  }

  @Override
  public Scanner getScanner() {
    return main.getScanner();
  }

  public FileConfiguration getChecksumDatabase() {
    return main.getChecksumDatabase();
  }

  public FileConfiguration getCheckDatabase() {
    return main.getCheckDatabase();
  }

  @Override
  public File getDataFolder() {
    return main.getDataFolder();
  }

  @Override
  public boolean canUseSpigotMethods() {
    return main.canUseSpigotMethods();
  }

  @Override
  public PluginIndex getPluginIndex() {
    return getCommandLineParser().getPluginIndex();
  }

  public static AntiMalware getInstance() {
    return (AntiMalware) AntiMalwareAPI.getInstance();
  }
}
