package optic_fusion1.mcantimalware.transformer;

import me.yamakaja.runtimetransformer.annotation.Inject;
import me.yamakaja.runtimetransformer.annotation.InjectionType;
import me.yamakaja.runtimetransformer.annotation.Transform;
import net.minecraft.server.v1_15_R1.EntityPlayer;
import org.bukkit.craftbukkit.v1_15_R1.entity.CraftPlayer;
import optic_fusion1.mcantimalware.runtimeprotect.callerinfo.CallerInfo;
import optic_fusion1.mcantimalware.runtimeprotect.callerinfo.RuntimeUtils;
import org.bukkit.craftbukkit.v1_15_R1.CraftServer;

@Transform(CraftPlayer.class)
public class EntityPlayerTransformer extends CraftPlayer {

  public EntityPlayerTransformer(CraftServer server, EntityPlayer entity) {
    super(server, entity);
  }

  @Inject(InjectionType.INSERT)
  @Override
  public void setOp(boolean value) {
    CallerInfo callerInfo = RuntimeUtils.getCallerInfo();
    if(callerInfo != null && value){
      System.out.println(callerInfo.getPlugin().getJar().toString() + " tried setting " + getDisplayName() + " to op");
    }
  }
}
